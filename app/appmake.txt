libs = ../api/std.lib ../api/fexos.lib ../api/string.lib
header = fexos.h macro.h

$(all): %.fex: %.c $(header) $(libs) fex.lds makefile
	gcc -c -m32 -O2 -std=c11 $*.c -o $*.o
	gld --gc-sections $*.o $(libs) -o $*.b -T fex.lds
	objcopy -O binary -j .text -j .rdata $*.b $*.bin
	mkexe -i $*.bin -o $*.fex -d 16 -b 0 -e 0
